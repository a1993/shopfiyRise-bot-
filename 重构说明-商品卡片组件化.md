# 商品卡片组件化重构说明

## 概述

本次重构将 `crazy-weekend-sale`、`flash-sale` 和 `halloween-hair-system-sale` 三个页面的商品卡片抽取为通用组件，提高代码复用性和可维护性。

## 新增文件

### 1. `snippets/product-card.liquid`
**通用商品卡片组件**

支持多种卡片样式：
- `crazy` - Crazy Weekend Sale 样式
- `flash` - Flash Sale 样式  
- `halloween` - Halloween Sale 样式
- `standard` - 标准样式（默认）

**主要参数：**
```liquid
{% render 'product-card',
  product: product,                    # 商品对象
  card_style: 'crazy',                 # 卡片样式
  card_type: 'type1',                  # 卡片类型（仅crazy样式）
  show_reviews: true,                  # 是否显示评论
  discount_percent: 15,                # 折扣百分比
  currency_symbol: '$',                # 货币符号
  button_text: 'Shop Now',             # 按钮文字
  badge_image: image_url,              # 徽章图片
  tag_image: image_url,                # 标签图片
  product_url: url,                    # 自定义链接
  product_title: title,                # 自定义标题
  product_desc: description,           # 商品描述
  old_price: '269.00',                 # 自定义原价
  new_price: '215.20',                 # 自定义折扣价
  shopify_attributes: block.shopify_attributes
%}
```

### 2. `snippets/product-grid.liquid`
**通用商品网格组件**

用于批量渲染商品卡片，支持不同布局样式。

**主要参数：**
```liquid
{% render 'product-grid',
  section_blocks: section.blocks,      # section blocks 数组
  grid_style: 'crazy',                 # 网格样式
  grid_class: 'custom-class',          # 额外CSS类
  card_style: 'crazy',                 # 传递给卡片的样式
  show_reviews: true,                  # 是否显示评论
  currency_symbol: '$',                # 货币符号
  discount_percent: 15,                # 统一折扣百分比
  filter_category: 1                   # 过滤分类编号
%}
```

### 3. `assets/product-card.css`
**商品卡片组件样式文件**

包含所有卡片样式的CSS，支持：
- 三种卡片样式的完整样式定义
- 响应式设计（移动端、平板、桌面端）
- 悬停效果和过渡动画
- 徽章、标签、按钮等元素样式

## 修改文件

### 1. `sections/crazy-weekend-sale.liquid`
**主要改动：**
- 引入 `product-card.css`
- 将商品卡片渲染替换为 `product-grid` 组件
- 保留 banner 和 section 配置
- 移除了重复的商品卡片HTML代码

**改动前：** ~130行代码渲染商品列表  
**改动后：** ~7行代码调用组件

### 2. `sections/flash-sale.liquid`
**主要改动：**
- 引入 `product-card.css`
- 将商品网格渲染替换为 `product-grid` 组件
- 保留 Tab 切换功能
- 移除了商品卡片HTML代码

**改动前：** ~90行代码渲染商品卡片  
**改动后：** ~9行代码调用组件

### 3. `sections/halloween-hair-system-sale.liquid`
**主要改动：**
- 引入 `product-card.css`
- 将商品卡片渲染替换为 `product-card` 组件
- 移除了标题和副标题设置（已有公共分区）
- 保留 Swiper 容器和导航按钮
- 移除了商品卡片HTML代码

**改动前：** ~80行代码渲染商品卡片  
**改动后：** ~7行代码调用组件

**Schema 改动：**
```json
// 移除了这些字段：
- category_title
- category_subtitle
```

### 4. `assets/crazy-weekend-sale.css`
**主要改动：**
- 移除商品卡片样式（已迁移到 `product-card.css`）
- 保留页面容器和布局样式
- 更新类名为 `product-grid--crazy`

### 5. `assets/flash-sale.css`
**主要改动：**
- 移除商品卡片样式（已迁移到 `product-card.css`）
- 保留 Tab 导航和容器样式
- 更新类名为 `product-grid--flash`

### 6. `assets/halloween-hair-system-sale.css`
**主要改动：**
- 移除商品卡片样式（已迁移到 `product-card.css`）
- 移除标题和副标题样式
- 保留 Swiper 容器和导航按钮样式

## 优势

### 1. **代码复用**
- 三个页面共享同一套商品卡片组件
- 减少重复代码约 200+ 行

### 2. **易于维护**
- 卡片样式集中管理
- 修改一处，三个页面同步更新

### 3. **灵活性**
- 支持多种卡片样式
- 通过参数控制显示内容
- 易于扩展新样式

### 4. **一致性**
- 确保所有页面的卡片样式保持一致
- 统一的HTML结构和CSS类名

### 5. **可读性**
- Section 代码更简洁
- 逻辑清晰，易于理解

## CSS 类名映射

### Crazy Weekend Sale
| 旧类名 | 新类名 |
|--------|--------|
| `.crazy-weekend-goods` | `.product-card--crazy` |
| `.crazy-goods-img` | `.product-card__image` |
| `.crazy-goods-main` | `.product-card__price-main` |
| `.crazy-goods-price` | `.product-card__price-group` |
| `.crazy-goods-oldprice` | `.product-card__price-old` |
| `.crazy-goods-newprice` | `.product-card__price-new` |
| `.crazy-goods-btn` | `.product-card__button` |
| `.crazy-goods-off` | `.product-card__badge-image` |

### Flash Sale
| 旧类名 | 新类名 |
|--------|--------|
| `.flash-sale-product-card` | `.product-card--flash` |
| `.flash-sale-product-image` | `.product-card__image` |
| `.flash-sale-product-title` | `.product-card__title` |
| `.flash-sale-product-price` | `.product-card__price` |
| `.flash-sale-price-sale` | `.product-card__price-sale` |
| `.flash-sale-price-compare` | `.product-card__price-compare` |
| `.flash-sale-discount-badge` | `.product-card__discount-badge` |
| `.flash-sale-hot-tag` | `.product-card__hot-tag` |

### Halloween Sale
| 旧类名 | 新类名 |
|--------|--------|
| `.halloween-product-card` | `.product-card--halloween` |
| `.halloween-product-image` | `.product-card__image` |
| `.halloween-product-title` | `.product-card__title` |
| `.halloween-product-price` | `.product-card__price` |
| `.halloween-price-sale` | `.product-card__price-sale` |
| `.halloween-price-compare` | `.product-card__price-compare` |
| `.halloween-badges` | `.product-card__badges` |
| `.halloween-badge` | `.product-card__badge` |
| `.halloween-shop-button` | `.product-card__shop-button` |

## 使用示例

### 在新页面中使用商品卡片组件

```liquid
<!-- 单个商品卡片 -->
{% render 'product-card',
  product: product,
  card_style: 'flash',
  show_reviews: true,
  button_text: 'Buy Now'
%}

<!-- 商品网格 -->
{% render 'product-grid',
  section_blocks: section.blocks,
  grid_style: 'halloween',
  show_reviews: true
%}
```

## 注意事项

1. **样式兼容性**：新的 CSS 类名与旧的完全兼容，无需修改现有样式
2. **JavaScript**：现有的 JavaScript 代码无需修改，仍然可以正常工作
3. **主题编辑器**：在 Shopify 主题编辑器中的所有功能保持不变
4. **性能**：组件化不影响页面加载性能，反而减少了 HTML 体积

## 后续建议

1. 可以进一步抽取 Tab 导航组件
2. 可以创建统一的价格显示组件
3. 可以为徽章和标签创建独立的 snippet
4. 考虑添加更多卡片样式变体

## 测试检查清单

- [ ] Crazy Weekend Sale 页面显示正常
- [ ] Flash Sale 页面 Tab 切换正常
- [ ] Halloween Sale 页面 Swiper 滑动正常
- [ ] 移动端响应式显示正常
- [ ] 平板端响应式显示正常
- [ ] 桌面端显示正常
- [ ] 商品卡片悬停效果正常
- [ ] 价格显示正确
- [ ] 徽章和标签显示正确
- [ ] 主题编辑器功能正常

---

**重构完成日期：** 2025-11-03  
**重构文件数量：** 9 个文件  
**新增文件：** 3 个  
**修改文件：** 6 个

